<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Data source environments — new_src_tbl • ICU data with R</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Data source environments — new_src_tbl" />
<meta property="og:description" content="Attaching a data source (see attach_src()) instantiates two types of S3
classes: a single src_env object, representing the data source as
collection of tables, as well as a src_tbl objects per table,
representing the given table. Upon package loading, src_env objects
including the respective src_tbl objects are created for all data sources
that are configured for auto-attaching, irrespective of whether data is
actually available. If some (or all) data is missing, the user is asked for
permission to download in interactive sessions and an error is thrown in
non-interactive sessions. See setup_src_env() for manually downloading
and setting up data sources." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ICU data with R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ricu.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jss.pdf">ricu: R's Interface to Intensive Care Data (PDF)</a>
    </li>
    <li>
      <a href="../articles/uom.html">Units of measurement</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/eth-mds/ricu">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Data source environments</h1>
    
    <div class="hidden name"><code>src_env.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Attaching a data source (see <code><a href='attach_src.html'>attach_src()</a></code>) instantiates two types of S3
classes: a single <code>src_env</code> object, representing the data source as
collection of tables, as well as a <code>src_tbl</code> objects per table,
representing the given table. Upon package loading, <code>src_env</code> objects
including the respective <code>src_tbl</code> objects are created for all data sources
that are configured for auto-attaching, irrespective of whether data is
actually available. If some (or all) data is missing, the user is asked for
permission to download in interactive sessions and an error is thrown in
non-interactive sessions. See <code><a href='attach_src.html'>setup_src_env()</a></code> for manually downloading
and setting up data sources.</p>
    </div>

    <pre class="usage"><span class='fu'>new_src_tbl</span><span class='op'>(</span><span class='va'>files</span>, <span class='va'>col_cfg</span>, <span class='va'>tbl_cfg</span>, <span class='va'>prefix</span>, <span class='va'>src_env</span><span class='op'>)</span>

<span class='fu'>is_src_tbl</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='fu'>as_src_tbl</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for src_env</span>
<span class='fu'>as_src_tbl</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>tbl</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>new_src_env</span><span class='op'>(</span><span class='va'>x</span>, env <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>new.env</a></span><span class='op'>(</span>parent <span class='op'>=</span> <span class='fu'>data_env</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>, link <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>is_src_env</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S3 method for src_env</span>
<span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>as_src_env</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='fu'>attached_srcs</span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'>is_tbl_avail</span><span class='op'>(</span><span class='va'>tbl</span>, <span class='va'>env</span><span class='op'>)</span>

<span class='fu'>src_tbl_avail</span><span class='op'>(</span><span class='va'>env</span>, tbls <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span><span class='op'>(</span>envir <span class='op'>=</span> <span class='va'>env</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>src_data_avail</span><span class='op'>(</span>src <span class='op'>=</span> <span class='fu'><a href='data_dir.html'>auto_attach_srcs</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>is_data_avail</span><span class='op'>(</span>src <span class='op'>=</span> <span class='fu'><a href='data_dir.html'>auto_attach_srcs</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>files</th>
      <td><p>File names of <code>fst</code> files that will be used to create a <code>prt</code>
object (see also <code><a href='https://nbenn.github.io/prt/reference/new_prt.html'>prt::new_prt()</a></code>)</p></td>
    </tr>
    <tr>
      <th>col_cfg</th>
      <td><p>Coerced to <code>col_cfg</code> by calling <code><a href='new_src_cfg.html'>as_col_cfg()</a></code></p></td>
    </tr>
    <tr>
      <th>tbl_cfg</th>
      <td><p>Coerced to <code>tbl_cfg</code> by calling <code><a href='new_src_cfg.html'>as_tbl_cfg()</a></code></p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>Character vector valued data source name(s) (used as class
prefix)</p></td>
    </tr>
    <tr>
      <th>src_env</th>
      <td><p>The data source environment (as <code>src_env</code> object)</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Object to test/coerce</p></td>
    </tr>
    <tr>
      <th>tbl</th>
      <td><p>String-valued table name</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>Environment used as <code>src_env</code></p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p><code>NULL</code> or a second environment (in addition to <code>data_env()</code>) in
which the resulting <code>src_env</code> is bound to a name</p></td>
    </tr>
    <tr>
      <th>tbls</th>
      <td><p>Character vector of table names</p></td>
    </tr>
    <tr>
      <th>src</th>
      <td><p>Character vector of data source names or any other object (or
list thereof) for which an <code>as_src_env()</code> method exists</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The constructors <code>new_src_env()</code>/<code>new_src_tbl()</code> as well as coercion
functions <code>as_src_env()</code>/<code>as_src_tbl()</code> return <code>src_env</code> and <code>src_tbl</code>
objects respectively, while inheritance testers <code>is_src_env()</code>/
<code>is_src_tbl()</code> return logical flags. For data availability utilities, see
Details section.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A <code>src_env</code> object is an environment with attributes <code>src_name</code> (a
string-valued data source name, such as <code>mimic_demo</code>) and <code>id_cfg</code>
(describing the possible patient IDs for the given data source). In
addition to the <code>src_env</code> class attribute, sub-classes are defined by the
source <code>class_prefix</code> configuration setting (see <code><a href='load_src_cfg.html'>load_src_cfg()</a></code>). Such
data source environments are intended to contain several corresponding
<code>src_tbl</code> objects (or rather active bindings that evaluate to <code>src_tbl</code>
objects; see <code><a href='attach_src.html'>setup_src_env()</a></code>).</p>
<p>The S3 class <code>src_tbl</code> inherits from <code><a href='https://nbenn.github.io/prt/reference/new_prt.html'>prt</a></code>, which
represents a partitioned <code><a href='http://www.fstpackage.org/reference/fst.html'>fst</a></code> file. In addition to the <code>prt</code>
object, meta data in the form of <code>col_cfg</code> and <code>tbl_cfg</code> is associated with
a <code>src_tbl</code> object (see <code><a href='load_src_cfg.html'>load_src_cfg()</a></code>). Furthermore, sub-classes are
added as specified by the source configuration <code>class_prefix</code> entry, as
with <code>src_env</code> objects. This allows certain functionality, for example data
loading, to be adapted to data source-specific requirements.</p>
<p>Instantiation and set up of <code>src_env</code> objects is possible irrespective of
whether the underlying data is available. If some (or all) data is missing,
the user is asked for permission to download in interactive sessions and an
error is thrown in non-interactive sessions upon first access of a
<code>src_tbl</code> bound as set up by <code><a href='attach_src.html'>setup_src_env()</a></code>. Data availability can be
checked with the following utilities:</p><ul>
<li><p><code>is_tbl_avail()</code>: Returns a logical flag indicating whether all required
data for the table passed as <code>tbl</code> which may be a string or any object
that has a <code><a href='new_src_cfg.html'>tbl_name()</a></code> implementation is available from the environment
<code>env</code> (requires an <code>as_src_env()</code> method).</p></li>
<li><p><code>src_tbl_avail()</code>: Returns a named logical vector, indicating which tables
have all required data available. As above, both <code>tbls</code> (arbitrary
length) and <code>env</code> (scalar-valued) may be character vectors or objects
with corresponding <code><a href='new_src_cfg.html'>tbl_name()</a></code> and <code>as_src_env()</code> methods.</p></li>
<li><p><code>src_data_avail()</code>: The most comprehensive data availability report can
be generated by calling <code>src_data_avail()</code>, returning a <code>data.frame</code> with
columns <code>name</code> (the data source name), <code>available</code> (logical vector
indicating whether all data is available), <code>tables</code> (the number of
available tables) and <code>total</code> (the total number of tables). As input,
<code>src</code> may be an arbitrary length character vector, an object for which an
<code>as_src_env()</code> method is defined or an arbitrary-length list thereof.</p></li>
<li><p><code>is_data_avail()</code>: Returns a named logical vector, indicating for which
data sources all required data is available. As above, <code>src</code> may be an
arbitrary length character vector, an object for which an <code>as_src_env()</code>
method is defined or an arbitrary-length list thereof.</p></li>
</ul>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nicolas Bennett, Drago Plecko, Ida-Fong Ukor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


