<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Concept callback functions — pafi • ICU data with R</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Concept callback functions — pafi"><meta property="og:description" content="Owing to increased complexity and more diverse applications, recursive
concepts (class rec_cncpt) may specify callback functions
to be called on corresponding data objects and perform post-processing
steps."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ICU data with R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ricu.pdf">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/start.html">Quick start guide</a>
    </li>
    <li>
      <a href="../articles/uom.html">Units of measurement</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/eth-mds/ricu" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Concept callback functions</h1>
    
    <div class="hidden name"><code>callback_cncpt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Owing to increased complexity and more diverse applications, recursive
concepts (class <code><a href="data_concepts.html">rec_cncpt</a></code>) may specify callback functions
to be called on corresponding data objects and perform post-processing
steps.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pafi</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  match_win <span class="op">=</span> <span class="fu"><a href="difftime.html">hours</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"match_vals"</span>, <span class="st">"extreme_vals"</span>, <span class="st">"fill_gaps"</span><span class="op">)</span>,</span>
<span>  fix_na_fio2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">safi</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  match_win <span class="op">=</span> <span class="fu"><a href="difftime.html">hours</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"match_vals"</span>, <span class="st">"extreme_vals"</span>, <span class="st">"fill_gaps"</span><span class="op">)</span>,</span>
<span>  fix_na_fio2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vent_ind</span><span class="op">(</span><span class="va">...</span>, match_win <span class="op">=</span> <span class="fu"><a href="difftime.html">hours</a></span><span class="op">(</span><span class="fl">6L</span><span class="op">)</span>, min_length <span class="op">=</span> <span class="fu"><a href="difftime.html">mins</a></span><span class="op">(</span><span class="fl">30L</span><span class="op">)</span>, interval <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gcs</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  valid_win <span class="op">=</span> <span class="fu"><a href="difftime.html">hours</a></span><span class="op">(</span><span class="fl">6L</span><span class="op">)</span>,</span>
<span>  sed_impute <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"max"</span>, <span class="st">"prev"</span>, <span class="st">"none"</span>, <span class="st">"verb"</span><span class="op">)</span>,</span>
<span>  set_na_max <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">urine24</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  min_win <span class="op">=</span> <span class="fu"><a href="difftime.html">hours</a></span><span class="op">(</span><span class="fl">12L</span><span class="op">)</span>,</span>
<span>  limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_var <span class="op">=</span> <span class="st">"start"</span>,</span>
<span>  end_var <span class="op">=</span> <span class="st">"end"</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vaso60</span><span class="op">(</span><span class="va">...</span>, max_gap <span class="op">=</span> <span class="fu"><a href="difftime.html">mins</a></span><span class="op">(</span><span class="fl">5L</span><span class="op">)</span>, interval <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vaso_ind</span><span class="op">(</span><span class="va">...</span>, interval <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">supp_o2</span><span class="op">(</span><span class="va">...</span>, interval <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">avpu</span><span class="op">(</span><span class="va">...</span>, interval <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bmi</span><span class="op">(</span><span class="va">...</span>, interval <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">norepi_equiv</span><span class="op">(</span><span class="va">...</span>, interval <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>...</dt>
<dd><p>Data input used for concept calculation</p></dd>


<dt>match_win</dt>
<dd><p>Time-span during which matching of values is allowed</p></dd>


<dt>mode</dt>
<dd><p>Method for matching PaO<sub>2</sub> and FiO<sub>2</sub> values</p></dd>


<dt>fix_na_fio2</dt>
<dd><p>Logical flag indicating whether to impute missing
FiO<sub>2</sub> values with 21</p></dd>


<dt>interval</dt>
<dd><p>Expected time series step size (determined from data if
<code>NULL</code>)</p></dd>


<dt>min_length</dt>
<dd><p>Minimal time span between a ventilation start and end
time</p></dd>


<dt>valid_win</dt>
<dd><p>Maximal time window for which a GCS value is valid
if no newer measurement is available</p></dd>


<dt>sed_impute</dt>
<dd><p>Imputation scheme for values taken when patient was
sedated (i.e. unconscious).</p></dd>


<dt>set_na_max</dt>
<dd><p>Logical flag controlling imputation of missing GCS values
with the respective maximum values</p></dd>


<dt>min_win</dt>
<dd><p>Minimal time span required for calculation of urine/24h</p></dd>


<dt>limits</dt>
<dd><p>Passed to <code><a href="ts_utils.html">fill_gaps()</a></code> in order to expand the time series
beyond first and last measurements</p></dd>


<dt>start_var, end_var</dt>
<dd><p>Passed to <code><a href="ts_utils.html">fill_gaps()</a></code></p></dd>


<dt>max_gap</dt>
<dd><p>Maximum time gap between administration windows that are
merged (can be negative).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Either an <code>id_tbl</code> or <code>ts_tbl</code> depending on the type of concept.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Several concept callback functions are exported, mainly for documenting
their arguments, as default values oftentimes represent somewhat arbitrary
choices and passing non-default values might be of interest for
investigating stability with respect to such choices. Furthermore, default
values might not be ideal for some datasets and/or analysis tasks.</p><div class="section">
<h3 id="pafi"><code>pafi</code><a class="anchor" aria-label="anchor" href="#pafi"></a></h3>


<p>In order to calculate the PaO<sub>2</sub>/FiO<sub>2</sub> (or Horowitz index), for
a given time point, both a PaO<sub>2</sub> and an FiO<sub>2</sub> measurement is
required. As the two are often not measured at the same time, some form of
imputation or matching procedure is required. Several options are available:</p><ul><li><p><code>match_vals</code> allows for a time difference of maximally <code>match_win</code>
between two measurements for calculating their ratio</p></li>
<li><p><code>extreme_vals</code> uses the worst PaO<sub>2</sub> and FiO<sub>2</sub> values within
the time window spanned by <code>match_win</code></p></li>
<li><p><code>fill_gaps</code> represents a variation of <code>extreme_vals</code>, where ratios are
evaluated at every time-point as specified by <code>interval</code>as opposed to
only the time points where either a PaO<sub>2</sub> or an FiO<sub>2</sub>
measurement is available</p></li>
</ul><p>Finally, <code>fix_na_fio2</code> imputes all remaining missing FiO<sub>2</sub> with 21,
the percentage (by volume) of oxygen in (tropospheric) air.</p>
</div>

<div class="section">
<h3 id="vent-ind"><code>vent_ind</code><a class="anchor" aria-label="anchor" href="#vent-ind"></a></h3>


<p>Building on the atomic concepts <code>vent_start</code> and <code>vent_end</code>, <code>vent_ind</code>
determines time windows during which patients are mechanically ventilated
by combining start and end events that are separated by at most <code>match_win</code>
and at least <code>min_length</code>. Durations are represented by the <code>dur_var</code> column
in the returned <code>win_tbl</code> and the <code>data_var</code> column simply indicates the
ventilation status with <code>TRUE</code> values. Currently, no clear distinction
between invasive an non-invasive ventilation is made.</p>
</div>

<div class="section">
<h3 id="sed-gcs"><code>sed_gcs</code><a class="anchor" aria-label="anchor" href="#sed-gcs"></a></h3>


<p>In order to construct an indicator for patient sedation (used within the
context of <code>gcs</code>), information from the two concepts <code>ett_gcs</code> and <code>rass</code> is
pooled: A patient is considered sedated if intubated or has less or equal to
-2 on the Richmond Agitation-Sedation Scale.</p>
</div>

<div class="section">
<h3 id="gcs"><code>gcs</code><a class="anchor" aria-label="anchor" href="#gcs"></a></h3>


<p>Aggregating components of the Glasgow Coma Scale into a total score
(whenever the total score <code>tgcs</code> is not already available) requires
coinciding availability of an eye (<code>egcs</code>), verbal (<code>vgcs</code>) and motor
(<code>mgcs</code>) score. In order to match values, a last observation carry forward
imputation scheme over the time span specified by <code>valid_win</code> is performed.
Furthermore passing <code>"max"</code> as <code>sed_impute</code> will assume maximal points for
time steps where the patient is sedated (as indicated by <code>sed_gcs</code>), while
passing <code>"prev"</code>, will assign the last observed value previous to the
current sedation window and finally passing <code>FALSE</code> will in turn use raw
values. Finally, passing <code>TRUE</code> as <code>set_na_max</code> will assume maximal points
for missing values (after matching and potentially applying <code>sed_impute</code>).</p>
</div>

<div class="section">
<h3 id="urine-"><code>urine24</code><a class="anchor" aria-label="anchor" href="#urine-"></a></h3>


<p>Single urine output events are aggregated into a 24 hour moving window sum.
At default value of <code>limits = NULL</code>, moving window evaluation begins with
the first and ends with the last available measurement. This can however be
extended by passing an <code>id_tbl</code> object, such as for example returned by
<code><a href="stay_windows.html">stay_windows()</a></code> to full stay windows. In order to provide data earlier
than 24 hours before the evaluation start point, <code>min_win</code> specifies the
minimally required data window and the evaluation scheme is adjusted for
shorter than 24 hour windows.</p>
</div>

<div class="section">
<h3 id="vaso-"><code>vaso60</code><a class="anchor" aria-label="anchor" href="#vaso-"></a></h3>


<p>Building on concepts for drug administration rate and drug administration
durations, administration events are filtered if they do not fall into
administrations windows of at least 1h. The <code>max_gap</code> argument can be used
to control how far apart windows can be in order to be merged (negative
times are possible as well, meaning that even overlapping windows can be
considered as individual windows).</p>
</div>

    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicolas Bennett, Drago Plecko, Ida-Fong Ukor.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

