<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Low level functions for loading data — load_src • ICU data with R</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Low level functions for loading data — load_src" />
<meta property="og:description" content="Data loading involves a cascade of S3 generic functions, which can
individually be adapted to the specifics of individual data sources. A the
lowest level, load_scr is called, followed by load_difftime().
Functions up the chain, are described in load_id()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ICU data with R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ricu.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jss.pdf">ricu: R's Interface to Intensive Care Data (PDF)</a>
    </li>
    <li>
      <a href="../articles/uom.html">Units of measurement</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/eth-mds/ricu">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Low level functions for loading data</h1>
    
    <div class="hidden name"><code>load_src.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Data loading involves a cascade of S3 generic functions, which can
individually be adapted to the specifics of individual data sources. A the
lowest level, <code>load_scr</code> is called, followed by <code>load_difftime()</code>.
Functions up the chain, are described in <code><a href='load_id.html'>load_id()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>load_src</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for src_tbl</span>
<span class='fu'>load_src</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>rows</span>, cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for character</span>
<span class='fu'>load_src</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>src</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>load_difftime</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for mimic_tbl</span>
<span class='fu'>load_difftime</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>rows</span>,
  cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  id_hint <span class='op'>=</span> <span class='fu'><a href='id_vars.html'>id_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  time_vars <span class='op'>=</span> <span class='fu'>ricu</span><span class='fu'>::</span><span class='fu'><a href='id_vars.html'>time_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for eicu_tbl</span>
<span class='fu'>load_difftime</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>rows</span>,
  cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  id_hint <span class='op'>=</span> <span class='fu'><a href='id_vars.html'>id_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  time_vars <span class='op'>=</span> <span class='fu'>ricu</span><span class='fu'>::</span><span class='fu'><a href='id_vars.html'>time_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for hirid_tbl</span>
<span class='fu'>load_difftime</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>rows</span>,
  cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  id_hint <span class='op'>=</span> <span class='fu'><a href='id_vars.html'>id_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  time_vars <span class='op'>=</span> <span class='fu'>ricu</span><span class='fu'>::</span><span class='fu'><a href='id_vars.html'>time_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for aumc_tbl</span>
<span class='fu'>load_difftime</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>rows</span>,
  cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  id_hint <span class='op'>=</span> <span class='fu'><a href='id_vars.html'>id_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  time_vars <span class='op'>=</span> <span class='fu'>ricu</span><span class='fu'>::</span><span class='fu'><a href='id_vars.html'>time_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for miiv_tbl</span>
<span class='fu'>load_difftime</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>rows</span>,
  cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  id_hint <span class='op'>=</span> <span class='fu'><a href='id_vars.html'>id_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  time_vars <span class='op'>=</span> <span class='fu'>ricu</span><span class='fu'>::</span><span class='fu'><a href='id_vars.html'>time_vars</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for character</span>
<span class='fu'>load_difftime</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>src</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Object for which to load data</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Generic consistency</p></td>
    </tr>
    <tr>
      <th>rows</th>
      <td><p>Expression used for row subsetting (NSE)</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>Character vector of column names</p></td>
    </tr>
    <tr>
      <th>src</th>
      <td><p>Passed to <code><a href='new_src_tbl.html'>as_src_tbl()</a></code> in order to determine the data source</p></td>
    </tr>
    <tr>
      <th>id_hint</th>
      <td><p>String valued id column selection (not necessarily honored)</p></td>
    </tr>
    <tr>
      <th>time_vars</th>
      <td><p>Character vector enumerating the columns to be treated as
timestamps and thus returned as <code><a href='https://rdrr.io/r/base/difftime.html'>base::difftime()</a></code> vectors</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>data.table</code> object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A function extending the S3 generic <code>load_src()</code> is expected to load a
subset of rows/columns from a tabular data source. While the column
specification is provided as character vector of column names, the row
subsetting involves non-standard evaluation (NSE). Data-sets that are
included with <code>ricu</code> are represented by <code><a href='https://nbenn.github.io/prt/reference/new_prt.html'>prt</a></code> objects,
which use <code><a href='https://rlang.r-lib.org/reference/eval_tidy.html'>rlang::eval_tidy()</a></code> to evaluate NSE expressions. Furthermore,
<code>prt</code> objects potentially represent tabular data split into partitions and
row-subsetting expressions are evaluated per partition (see the <code>part_safe</code>
flag in <code><a href='https://nbenn.github.io/prt/reference/nse.html'>prt::subset.prt()</a></code>). The return value of <code>load_src()</code> is expected
to be of type <code>data.table</code>.</p>
<p>Timestamps are represented differently among the included data sources:
while MIMIC-III and HiRID use absolute date/times, eICU provides temporal
information as minutes relative to ICU admission. Other data sources, such
as the ICU dataset provided by Amsterdam UMC, opt for relative times as
well, but not in minutes since admission, but in milliseconds. In order to
smoothen out such discrepancies, the next function in the data loading
hierarchy is <code>load_difftime()</code>. This function is expected to call
<code>load_src()</code> in order to load a subset of rows/columns from a table stored
on disk and convert all columns that represent timestamps (as specified by
the argument <code>time_vars</code>) into <code><a href='https://rdrr.io/r/base/difftime.html'>base::difftime()</a></code> vectors using <code>mins</code> as
time unit.</p>
<p>The returned object should be of type <code>id_tbl</code>, with the ID vars
identifying the ID system the times are relative to. If for example all
times are relative to ICU admission, the ICU stay ID should be returned as
ID column. The argument <code>id_hint</code> may suggest an ID type, but if in the raw
data, this ID is not available, <code>load_difftime()</code> may return data using a
different ID system. In MIMIC-III, for example, data in the <code>labevents</code>
table is available for <code>subject_id</code> (patient ID) pr <code>hadm_id</code> (hospital
admission ID). If data is requested for <code>icustay_id</code> (ICU stay ID), this
request cannot be fulfilled and data is returned using the ID system with
the highest cardinality (among the available ones). Utilities such as
<code><a href='change_id.html'>change_id()</a></code> can the later be used to resolve data to <code>icustay_id</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://physionet.org/content/mimiciii-demo/1.4'>mimic.demo</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>tbl</span> <span class='op'>&lt;-</span> <span class='va'>mimic_demo</span><span class='op'>$</span><span class='va'>labevents</span>
<span class='va'>col</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"charttime"</span>, <span class='st'>"value"</span><span class='op'>)</span>

<span class='fu'>load_src</span><span class='op'>(</span><span class='va'>tbl</span>, <span class='va'>itemid</span> <span class='op'>==</span> <span class='fl'>50809</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span>
  <span class='fu'>load_src</span><span class='op'>(</span><span class='st'>"labevents"</span>, <span class='st'>"mimic_demo"</span>, <span class='va'>itemid</span> <span class='op'>==</span> <span class='fl'>50809</span>, cols <span class='op'>=</span> <span class='va'>col</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>load_difftime</span><span class='op'>(</span><span class='va'>tbl</span>, <span class='va'>itemid</span> <span class='op'>==</span> <span class='fl'>50809</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span>
  <span class='fu'>load_difftime</span><span class='op'>(</span><span class='va'>tbl</span>, <span class='va'>itemid</span> <span class='op'>==</span> <span class='fl'>50809</span>, <span class='va'>col</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'><a href='id_vars.html'>id_vars</a></span><span class='op'>(</span>
  <span class='fu'>load_difftime</span><span class='op'>(</span><span class='va'>tbl</span>, <span class='va'>itemid</span> <span class='op'>==</span> <span class='fl'>50809</span>, id_hint <span class='op'>=</span> <span class='st'>"icustay_id"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'><a href='id_vars.html'>id_vars</a></span><span class='op'>(</span>
  <span class='fu'>load_difftime</span><span class='op'>(</span><span class='va'>tbl</span>, <span class='va'>itemid</span> <span class='op'>==</span> <span class='fl'>50809</span>, id_hint <span class='op'>=</span> <span class='st'>"subject_id"</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; [1] "subject_id"</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nicolas Bennett, Drago Plecko, Ida-Fong Ukor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


