<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Data download utilities — download_src • ICU data with R</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Data download utilities — download_src"><meta property="og:description" content="Making a dataset available to ricu consists of 3 steps: downloading
(download_src()), importing (import_src()) and attaching
(attach_src()). While downloading and importing are one-time procedures,
attaching of the dataset is repeated every time the package is loaded.
Briefly, downloading loads the raw dataset from the internet (most likely
in .csv format), importing consists of some preprocessing to make the
data available more efficiently (by converting it to .fst
format) and attaching sets up the data for use by the package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ICU data with R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ricu.pdf">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/start.html">Quick start guide</a>
    </li>
    <li>
      <a href="../articles/uom.html">Units of measurement</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/eth-mds/ricu" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Data download utilities</h1>
    
    <div class="hidden name"><code>download.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Making a dataset available to <code>ricu</code> consists of 3 steps: downloading
(<code>download_src()</code>), importing (<code><a href="import.html">import_src()</a></code>) and attaching
(<code><a href="attach_src.html">attach_src()</a></code>). While downloading and importing are one-time procedures,
attaching of the dataset is repeated every time the package is loaded.
Briefly, downloading loads the raw dataset from the internet (most likely
in <code>.csv</code> format), importing consists of some preprocessing to make the
data available more efficiently (by converting it to <code><a href="http://www.fstpackage.org/reference/fst.html" class="external-link">.fst</a></code>
format) and attaching sets up the data for use by the package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">download_src</span><span class="op">(</span><span class="va">x</span>, data_dir <span class="op">=</span> <span class="fu"><a href="file_utils.html">src_data_dir</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for src_cfg</span></span>
<span><span class="fu">download_src</span><span class="op">(</span><span class="va">x</span>, data_dir <span class="op">=</span> <span class="fu"><a href="file_utils.html">src_data_dir</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, tables <span class="op">=</span> <span class="cn">NULL</span>, force <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for aumc_cfg</span></span>
<span><span class="fu">download_src</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  data_dir <span class="op">=</span> <span class="fu"><a href="file_utils.html">src_data_dir</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  tables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  token <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for character</span></span>
<span><span class="fu">download_src</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  data_dir <span class="op">=</span> <span class="fu"><a href="file_utils.html">src_data_dir</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  tables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  user <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pass <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Object specifying the source configuration</p></dd>


<dt>data_dir</dt>
<dd><p>Destination directory where the downloaded data is written
to.</p></dd>


<dt>...</dt>
<dd><p>Generic consistency</p></dd>


<dt>tables</dt>
<dd><p>Character vector specifying the tables to download. If
<code>NULL</code>, all available tables are downloaded.</p></dd>


<dt>force</dt>
<dd><p>Logical flag; if <code>TRUE</code>, existing data will be re-downloaded</p></dd>


<dt>token</dt>
<dd><p>Download token for AmsterdamUMCdb (see 'Details')</p></dd>


<dt>verbose</dt>
<dd><p>Logical flag indicating whether to print progress information</p></dd>


<dt>user, pass</dt>
<dd><p>PhysioNet credentials; if <code>NULL</code> and environment
variables <code>RICU_PHYSIONET_USER</code>/<code>RICU_PHYSIONET_PASS</code> are not set, user
input is required</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Called for side effects and returns <code>NULL</code> invisibly.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Downloads by <code>ricu</code> are focused data hosted by
<a href="https://physionet.org" class="external-link">PhysioNet</a> and tools are currently available for
downloading the datasets
<a href="https://physionet.org/content/mimiciii/1.4/" class="external-link">MIMIC-III</a>,
<a href="https://physionet.org/content/eicu-crd/2.0/" class="external-link">eICU</a> and
<a href="https://physionet.org/content/hirid/1.0/" class="external-link">HiRID</a> (see <a href="data_env.html">data</a>). While
credentials are required for downloading any of the three datasets, demo
dataset for both MIMIC-III and eICU are available without having to log in.
Even though access to full dataset is credentialed, the datasets are in
fact publicly available. For setting up an account, please refer to <a href="https://physionet.org/register/" class="external-link">the registration form</a>.</p>
<p>PhysioNet credentials can either be entered in an interactive session,
passed as function arguments <code>user</code>/<code>pass</code> or as environment
variables <code>RICU_PHYSIONET_USER</code>/<code>RICU_PHYSIONET_PASS</code>. For setting
environment variables on session startup, refer to <code><a href="https://rdrr.io/r/base/Startup.html" class="external-link">base::.First.sys()</a></code> and
for setting environment variables in general, refer to <code><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">base::Sys.setenv()</a></code>
If the openssl package is available, SHA256 hashes of downloaded files are
verified using <code><a href="https://rdrr.io/pkg/openssl/man/hash.html" class="external-link">openssl::sha256()</a></code>.</p>
<p>Demo datasets
<a href="https://physionet.org/content/mimiciii-demo/1.4/" class="external-link">MIMIC-III demo</a> and
<a href="https://physionet.org/content/eicu-crd-demo/2.0/" class="external-link">eICU demo</a> can either be
installed as R packages directly by running</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"mimic.demo"</span>, <span class="st">"eicu.demo"</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repos =</span> <span class="st">"https://eth-mds.github.io/physionet-demo"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre><p></p></div>
<p>or downloaded and imported using <code>download_src()</code> and <code><a href="import.html">import_src()</a></code>.
Furthermore, <code>ricu</code> specifies <code>mimic.demo</code> and <code>eicu.demo</code> as <code>Suggests</code>
dependencies therefore, passing <code>dependencies = TURE</code> when calling
<code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code> for installing <code>ricu</code>, this will automatically install
the demo datasets as well.</p>
<p>While the included data downloaders are intended for data hosted by
PhysioNet, <code>download_src()</code> is an S3 generic function that can be extended
to new classes. Method dispatch is intended to occur on objects that
inherit from or can be coerced to <code>src_cfg</code>. For more information on data
source configuration, refer to <code><a href="load_src_cfg.html">load_src_cfg()</a></code>.</p>
<p>As such, with the addition of the AmsterdamUMCdb dataset, which
unfortunately is not hosted on PhysioNet, A separate downloader for that
dataset is available as well. Currently this requires both availability of
the CRAN package <code>xml2</code>, as well as the command line utility 7zip.
Furthermore, data access has to be <a href="https://amsterdammedicaldatascience.nl/#amsterdamumcdb" class="external-link">requested </a> and for
non-interactive download the download token has to be made available as
environment variable <code>RICU_AUMC_TOKEN</code> or passed as <code>token</code> argument to
<code>download_src()</code>. The download token can be retrieved from the URL provided
when granted access as by extracting the string followed by <code>token=</code>:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>example.org<span class="sc">/</span>?s<span class="ot">=</span>download<span class="sc">&amp;</span>token<span class="ot">=</span>0c27af59<span class="sc">-</span>72d1<span class="dv">-0349</span><span class="sc">-</span>aa59<span class="sc">-</span>00000a8076d9</span></code></pre><p></p></div>
<p>would translate to</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>RICU_AUMC_TOKEN <span class="op">=</span> <span class="st">"0c27af59-72d1-0349-aa59-00000a8076d9"</span><span class="op">)</span></span></code></pre><p></p></div>
<p>If the dependencies outlined above are not fulfilled, download and archive
extraction can be carried out manually into the corresponding folder and
<code><a href="import.html">import_src()</a></code> can be run.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">download_datasource</span><span class="op">(</span><span class="st">"mimic_demo"</span>, data_dir <span class="op">=</span> <span class="va">dir</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicolas Bennett, Drago Plecko, Ida-Fong Ukor.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

